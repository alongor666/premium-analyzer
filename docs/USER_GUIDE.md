# 用户使用手册

欢迎使用保费收入多维度分析系统！本手册将帮助您快速上手并掌握系统的各项功能。

## 目录

- [快速开始](#快速开始)
- [功能概述](#功能概述)
- [数据上传](#数据上传)
- [数据筛选](#数据筛选)
- [视图分析](#视图分析)
- [数据导出](#数据导出)
- [快捷键](#快捷键)
- [常见问题](#常见问题)

---

## 快速开始

### 第一次使用

1. **打开系统**
   - 在浏览器中访问系统URL
   - 推荐使用 Chrome、Firefox 或 Edge 浏览器

2. **上传数据文件**
   - 点击"选择文件"按钮，或直接拖拽文件到上传区域
   - 支持格式：.csv, .xlsx, .xls
   - 文件大小不超过 10MB

3. **等待数据解析**
   - 系统会自动解析文件
   - 进度条显示解析进度

4. **开始分析**
   - 数据加载完成后，自动显示概览分析页面
   - 使用筛选器过滤数据
   - 切换不同视图查看分析结果

---

## 功能概述

### 4个分析视图

| 视图 | 功能描述 |
|------|----------|
| **概览分析** | 查看整体数据趋势、TOP排名机构 |
| **机构对比** | 横向对比各机构保费数据 |
| **维度分析** | 多维度分布饼图和排名柱状图 |
| **明细数据** | 详细数据表格，支持导出 |

### 9个分析维度

系统支持以下9个维度的筛选和分析：

1. **三级机构** - 各分支机构
2. **起保月** - 保险生效月份
3. **客户类别** - 客户类型分类
4. **能源类型** - 新能源/传统能源
5. **险别组合** - 保险组合类型
6. **是否过户车** - 过户车辆标识
7. **续保状态** - 续保情况
8. **险种** - 保险险种类型
9. **终端来源** - 销售渠道

### 4个核心指标

- **总保费收入** - 筛选后的保费总额
- **筛选保费** - 符合筛选条件的保费
- **保费占比** - 筛选保费占总保费的百分比
- **记录数量** - 符合条件的保单数量

---

## 数据上传

### 支持的文件格式

| 格式 | 扩展名 | 说明 |
|------|--------|------|
| CSV | `.csv` | 逗号分隔值文件 |
| Excel | `.xlsx`, `.xls` | Microsoft Excel 文件 |

### 文件要求

1. **文件大小**：不超过 10MB
2. **数据格式**：
   - 第一行应为列名（表头）
   - 包含保费相关字段
   - 建议包含日期字段

3. **必要字段**（至少包含一个）：
   - 保费收入
   - 保费
   - 签单保费
   - 保险费

### 上传步骤

**方法1：点击上传**
1. 点击"选择文件"按钮
2. 在文件选择对话框中选择文件
3. 等待上传和解析

**方法2：拖拽上传**
1. 将文件直接拖拽到上传区域
2. 松开鼠标开始上传
3. 等待解析完成

### 解析进度

上传后会看到：
- 加载动画
- 进度条（0% - 100%）
- 当前处理阶段提示

---

## 数据筛选

### 筛选器位置

左侧筛选面板，包含9个维度的下拉选择器。

### 筛选逻辑

- **多维度间**：AND 逻辑（所有条件必须同时满足）
- **同维度多值**：OR 逻辑（任一值匹配即可）

### 筛选步骤

1. **展开维度选择器**
   - 点击维度名称（如"三级机构"）
   - 下拉面板展开显示所有选项

2. **选择数值**
   - 勾选想要的选项
   - 可多选
   - 点击"全选"快速选择所有

3. **应用筛选**
   - 点击"应用筛选"按钮
   - 系统重新计算数据并更新图表

4. **查看筛选标签**
   - 已应用的筛选显示为标签
   - 点击标签上的 × 可移除该筛选

### 筛选示例

**示例1：查看特定机构的数据**
1. 展开"三级机构"
2. 勾选"北京分公司"、"上海分公司"
3. 点击"应用筛选"

**示例2：查看特定月份的特定客户类型**
1. 展开"起保月"，选择"2025-01"
2. 展开"客户类别"，选择"个人"
3. 点击"应用筛选"
4. 结果：2025年1月的个人客户数据

**示例3：清空筛选**
- 点击"清空"按钮
- 所有筛选条件被清除
- 显示全部数据

### 筛选配置保存

系统会自动保存您的筛选配置到浏览器本地存储。

---

## 视图分析

### 1. 概览分析

默认视图，展示整体数据概况。

#### 指标卡片

顶部显示4个核心指标：
- **总保费收入** - 全部数据保费总额
- **筛选保费** - 当前筛选条件下的保费
- **保费占比** - 筛选保费占比
- **记录数量** - 符合条件的记录数

#### 月度保费趋势图

- 图表类型：折线图
- 显示：各月份保费变化趋势
- 支持缩放、数据提示

#### TOP5机构保费排名

- 图表类型：柱状图
- 显示：保费前5名的机构
- 支持查看具体数值

---

### 2. 机构对比

专门用于横向对比各机构数据。

#### 机构保费对比图

- 图表类型：柱状图
- 显示：所有机构的保费对比
- 按保费降序排列
- 支持滚动查看更多机构

#### 使用场景

- 比较不同机构的业绩
- 找出表现最好/最差的机构
- 分析机构间差距

---

### 3. 维度分析

从多维度分析数据分布。

#### 维度分布饼图

- 显示：TOP10维度的保费占比
- 适合：查看集中度
- 功能：悬停查看详细数据

#### 维度排名柱状图

- 显示：TOP20维度的保费排名
- 适合：比较各维度表现
- 功能：点击查看详细数据

#### 使用场景

- 分析客户类别分布
- 查看各险种占比
- 对比不同渠道表现

---

### 4. 明细数据

表格形式展示所有聚合数据。

#### 表格列

| 列名 | 说明 |
|------|------|
| 维度 | 维度名称（如机构名） |
| 保费收入（万元） | 该维度的保费总额 |
| 占比 | 占总保费的百分比 |
| 记录数 | 该维度的保单数量 |

#### 表格功能

- **滚动**：滚动查看更多数据
- **悬停**：高亮当前行
- **导出**：点击"导出数据"按钮导出表格

---

## 数据导出

### 支持的导出格式

| 格式 | 扩展名 | 说明 |
|------|--------|------|
| Excel | `.xlsx` | Microsoft Excel 格式，支持格式化 |
| CSV | `.csv` | 逗号分隔值，通用格式 |

### 导出步骤

1. 切换到"明细数据"标签页
2. 点击"导出数据"按钮
3. 选择导出格式：
   - 点击"确定"导出为 Excel (.xlsx)
   - 点击"取消"导出为 CSV (.csv)
4. 文件自动下载到浏览器默认下载目录

### 导出文件内容

导出文件包含以下列：
- 维度
- 保费收入（万元）
- 占比
- 记录数
- 平均单均保费

### 文件命名

导出文件自动命名为：`保费分析_YYYY-MM-DD.xlsx/csv`
- 例如：`保费分析_2025-03-15.xlsx`

---

## 快捷键

系统支持以下快捷键（Windows/Linux使用Ctrl，Mac使用Cmd）：

| 快捷键 | 功能 |
|--------|------|
| `Ctrl + S` | 应用筛选 |
| `Ctrl + R` | 重置/清空筛选 |
| `Ctrl + E` | 导出数据 |
| `Ctrl + 1` | 切换到概览分析页 |
| `Ctrl + 2` | 切换到机构对比页 |
| `Ctrl + 3` | 切换到维度分析页 |
| `Ctrl + 4` | 切换到明细数据页 |

### 使用提示

- 快捷键在数据加载后生效
- 部分快捷键仅在特定视图下有效
- 浏览器本身的快捷键可能冲突

---

## 常见问题

### Q1: 文件上传失败怎么办？

**可能原因和解决方案：**

1. **文件格式不正确**
   - 确保文件是 .csv、.xlsx 或 .xls 格式
   - 检查文件是否损坏

2. **文件过大**
   - 文件大小不能超过 10MB
   - 尝试拆分文件或删除不必要的行列

3. **网络问题**
   - 检查网络连接
   - 刷新页面重试

4. **浏览器不支持**
   - 使用最新版本的 Chrome、Firefox 或 Edge
   - 不支持 Internet Explorer

---

### Q2: 图表不显示怎么办？

**可能原因和解决方案：**

1. **数据格式问题**
   - 检查Excel文件中是否有保费列
   - 确保保费列是数值格式

2. **浏览器缓存**
   - 清除浏览器缓存
   - 刷新页面 (Ctrl + F5)

3. **JavaScript 错误**
   - 打开浏览器开发者工具 (F12)
   - 查看 Console 标签页的错误信息
   - 截图并联系技术支持

---

### Q3: 筛选结果不符合预期？

**检查清单：**

1. **确认筛选逻辑**
   - 多维度间是 AND 关系
   - 同维度多选是 OR 关系

2. **查看已应用筛选标签**
   - 确认筛选条件正确
   - 移除不需要的筛选

3. **清空筛选重试**
   - 点击"清空"按钮
   - 重新设置筛选条件

---

### Q4: 导出功能不工作？

**可能原因和解决方案：**

1. **没有数据**
   - 确保已上传文件并解析成功
   - 检查筛选后是否有数据

2. **浏览器阻止下载**
   - 检查浏览器下载设置
   - 允许网站下载文件

3. **文件格式不支持**
   - 确保浏览器支持 Excel/CSV 下载
   - 尝试使用其他格式

---

### Q5: 如何查看更多数据？

**方法：**

1. **调整筛选条件**
   - 减少筛选条件
   - 查看更多维度的数据

2. **切换聚合维度**
   - 当前按"三级机构"聚合
   - 可改为按"起保月"或其他维度

3. **使用明细数据视图**
   - 切换到"明细数据"标签页
   - 查看完整的聚合结果表格

---

### Q6: 数据会保存吗？

**说明：**

- **筛选配置**：自动保存到浏览器本地存储
- **上传的文件**：不会保存，刷新页面需要重新上传
- **分析结果**：不会保存，刷新页面需要重新分析

**建议：**
- 定期导出分析结果
- 保存重要的Excel文件

---

### Q7: 支持移动设备吗？

**支持情况：**

- 系统已进行移动端适配
- 支持平板和手机访问
- 小屏幕下布局会自动调整

**移动端注意事项：**
- 建议横屏使用以获得更好体验
- 部分图表可能需要缩放查看
- 大文件上传可能较慢

---

### Q8: 如何获得技术支持？

**联系方式：**

1. **查看文档**
   - API文档：`docs/API.md`
   - 部署指南：`docs/DEPLOYMENT.md`

2. **提交问题**
   - 截图错误信息
   - 描述操作步骤
   - 说明浏览器版本

3. **联系方式**
   - 邮箱：support@example.com
   - GitHub Issues：项目仓库

---

## 最佳实践

### 数据准备建议

1. **数据清洗**
   - 删除空行和空列
   - 统一日期格式
   - 检查数值格式

2. **字段命名**
   - 使用清晰的列名
   - 包含必要的业务字段
   - 避免特殊字符

3. **文件大小**
   - 合理控制数据量
   - 大文件考虑拆分
   - 定期清理历史数据

### 分析技巧

1. **从整体到局部**
   - 先看概览分析了解整体
   - 再使用筛选逐步聚焦

2. **多维度对比**
   - 切换不同聚合维度
   - 比较不同维度的表现

3. **关注异常值**
   - 查看排名首尾的数据
   - 分析原因和影响

4. **定期导出**
   - 保存分析结果
   - 制作定期报告

---

## 系统要求

### 浏览器要求

| 浏览器 | 最低版本 | 推荐版本 |
|--------|----------|----------|
| Chrome | 90+ | 最新版 |
| Firefox | 88+ | 最新版 |
| Safari | 14+ | 最新版 |
| Edge | 90+ | 最新版 |

### 设备要求

- **桌面端**：任何现代电脑
- **移动端**：iOS 14+, Android 10+
- **网络**：稳定的互联网连接

---

## 更新日志

### v1.0.0 (2025-03-15)

#### 新功能
- ✅ 支持9个维度的多维度分析
- ✅ 4个分析视图（概览、对比、维度、明细）
- ✅ 数据导出为Excel/CSV
- ✅ 筛选配置本地保存
- ✅ 进度条显示
- ✅ 移动端适配
- ✅ 快捷键支持
- ✅ 数据查询缓存

#### 修复
- 🐛 修复字段映射bug
- 🐛 修复格式化函数缺失
- 🐛 增强调试日志

---

## 感谢使用！

如有任何问题或建议，欢迎随时联系我们。

祝您使用愉快！
